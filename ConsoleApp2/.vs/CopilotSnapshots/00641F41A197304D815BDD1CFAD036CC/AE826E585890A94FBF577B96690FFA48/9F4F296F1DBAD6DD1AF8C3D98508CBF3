using System;
using ConsoleApp2.Models;

namespace ConsoleApp2.Models
{
    public static class ExtensionMethods
    {
        /// <summary>
        /// Kart nömrəsini 1234 **** **** 5678 formatında mask edir
        /// </summary>
        public static string MaskCardNumber(this Card card)
        {
            if (string.IsNullOrEmpty(card.CardNumber) || card.CardNumber.Length != 16)
                return card.CardNumber;
            
            return $"{card.CardNumber.Substring(0, 4)} **** **** {card.CardNumber.Substring(12, 4)}";
        }
        
        /// <summary>
        /// Xərclənən məbləğə görə bonus hesablayır və kartdan pul çıxarır
        /// </summary>
        public static bool ExpenseAndGetBonus(this Card card, double amount)
        {
            if (amount <= 0)
                return false;
                
            // Kartdan pul çıxarma cəhdi
            if (!card.WithDraw(amount))
                return false;
            
            // Bank tipinə görə bonus hesablama
            double bonusPercentage = card.Bank switch
            {
                Bank.ABB => 0.02,      // 2%
                Bank.Leo => 0.04,      // 4%
                Bank.Kapital => 0.05,  // 5%
                _ => 0.0
            };
            
            // Bonusu əlavə et
            card.Bonus += amount * bonusPercentage;
            
            return true;
        }
    }
}
